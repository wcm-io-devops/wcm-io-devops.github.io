
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2024-12-09
 Rendered using Reflow Maven Skin 1.2.0 (https://github.com/wcm-io/wcm-io-tooling/tree/develop/maven/skins/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

  <head>
    <meta charset="UTF-8" />
    <title>Multi-module projects with WTP | wcm.io DevOps Eclipse Maven Plugin</title>

    <link rel="shortcut icon" href="https://wcm.io/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://wcm.io/images/favicon-152.png">

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="wcm.io DevOps - Tools for Configuration Management and Deployment" />
    <meta name="author" content="Roland Asmann
Richard van Nieuwenhoven" />
    <meta http-equiv="content-language" content="en" />

    <link href="https://devops.wcm.io/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://devops.wcm.io/css/docs.css" rel="stylesheet" />
    <link href="https://devops.wcm.io/css/reflow-skin.css" rel="stylesheet" />
    <link href="https://devops.wcm.io/css/highlightjs-style-github.min.css" rel="stylesheet" />

    <link href="https://devops.wcm.io/css/lightbox.css" rel="stylesheet" />

    <link href="https://devops.wcm.io/css/site.css" rel="stylesheet" />
    <link href="https://devops.wcm.io/css/print.css" rel="stylesheet" media="print" />


  </head>

  <body class="page-examples-multi-module-projects project-eclipse-maven-plugin" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="../../../..">wcm.io DevOps</a>
          <div class="nav-collapse collapse" id="top-nav-collapse">
            <ul class="nav pull-right">
              <li ><a href="http://github.com/wcm-io-devops" title="GitHub project" class="externalLink">GitHub project</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Categories <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="../../../../conga/" title="CONGA - CONfiguration GenerAtor">CONGA - CONfiguration GenerAtor</a></li>
                </ul>
              </li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li ><a href="https://wcm.io/contribute.html" title="Contribute" class="externalLink">Contribute</a></li>
                  <li ><a href="https://github.com/wcm-io-devops" title="Issues" class="externalLink">Issues</a></li>
                  <li ><a href="https://wcm-io.atlassian.net/wiki/" title="Wiki" class="externalLink">Wiki</a></li>
                  <li ><a href="https://wcm.io/mailing-lists.html" title="Mailing Lists" class="externalLink">Mailing Lists</a></li>
                  <li ><a href="http://github.com/wcm-io-devops" title="Fork on GitHub" class="externalLink">Fork on GitHub</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  <div class="container">

  <!-- Masthead
  ================================================== -->

  <header>
  <div class="jumbotron subhead">
    <div class="row" id="banner">
      <div class="span12">
        <div class="pull-left">
          <a href="../../../../" id="bannerLeft"><h1><img src="https://wcm.io/images/favicon-16@3x.png"/> wcm.io DevOps</h1></a>
          <p class="lead">Tools for Configuration Management and Deployment</p>
        </div>
        <div class="pull-right">
        </div>
      </div>
    </div>
  </div>
    <div>
      <ul class="breadcrumb">
        <li><a href="../../../../" title="wcm.io DevOps">wcm.io DevOps</a></li>
        <li class="divider">/</li>
        <li><a href="../index.html" title="wcm.io DevOps Eclipse Maven Plugin">wcm.io DevOps Eclipse Maven Plugin</a></li>
        <li class="divider">/</li>
        <li>Multi-module projects with WTP</li>
      </ul>
    </div>
  </header>

  <div class="main-body">
  <div class="row">
    <div class="span8">
      <div class="body-content">
<section> 
 <div class="page-header">
  <h2 id="Using_maven-eclipse-plugin_in_multi-module_projects_with_WTP">Using maven-eclipse-plugin in multi-module projects with WTP</h2>
 </div> 
 <p>Developing Multi-module projects with Maven and Eclipse can be done efficiently using the the best of both Maven 2 and Eclipse's WTP. </p> 
 <p>Especially with projects that have EJB and EAR modules, it can be difficult to use Maven 2.0 and WTP. There are however good solutions to these obstacles, without losing any of the functionality of either Maven nor WTP.</p> 
 <section> 
  <h3 id="The_flat_project_structure">The flat project structure</h3> 
  <p>One of the major problems that occur when using Maven and Eclipse together, is that Maven encourages the use of deep project structures, whereas eclipse can't handle those. A solution to this problem is to force Maven to use the flat structure:</p> 
  <div class="source"> 
   <pre>.....
&lt;modules&gt;
  &lt;module&gt;../module1&lt;/module&gt;
  &lt;module&gt;../module2&lt;/module&gt;
&lt;/modules&gt;
.....</pre> 
  </div> 
  <p>This has some very big drawbacks: You will lose the possibility to use several of Maven's tools (eg the release-plugin), because these are unable to handle flat structures.</p> 
  <p>The best approach is to do everything the way it was intended in Maven, and let the maven-eclipse-plugin bend WTP to its will. Therefore, the recommendation would be to use the deep structures:</p> 
  <div class="source"> 
   <pre>.....
&lt;modules&gt;
  &lt;module&gt;module1&lt;/module&gt;
  &lt;module&gt;module2&lt;/module&gt;
&lt;/modules&gt;
.....</pre> 
  </div> 
 </section> 
 <section> 
  <h3 id="The_Example_project">The Example project</h3> 
  <p>This project is an example of a multi-module projects, containing some JAR-, a WAR- and an EAR-project. You can download it from <a href="./j2ee-simple.tar.gz">here</a>. The project is based on the j2ee-simple archetype.</p> 
  <section> 
   <h4 id="Step_by_step">Step by step</h4> 
   <p>Follow the example steps to install the multi-module project in your Eclipse.</p> 
   <ul> 
    <li>create a new workspace with Eclipse 3.3 and WTP 2.0</li> 
    <li>define the <code>M2_REPO</code> variable in Eclipse</li> 
    <li>extract the example project somewhere</li> 
    <li>start '<code>mvn eclipse:eclipse install</code>' from the command-line in the root project (j2ee-simple)</li> 
    <li>use the <a href="#Multi_Project_Import_Export_Plugin">Multi Project Import/Export Plugin</a> to import all the modules into Eclipse</li> 
    <li>define your favorite application server in the WTP Server view</li> 
    <li>add and publish the project to the server </li> 
    <li>start the server</li> 
    <li>open your browser to <a class="externalLink" href="http://localhost:8080/servlet/hello">http://localhost:8080/servlet/hello</a></li> 
    <li>your maven project is up and running as a eclipse / wtp project</li> 
   </ul> 
  </section> 
 </section> 
 <section> 
  <h3 id="Source_Control_Management">Source Control Management</h3> 
  <p>Eclipse and Maven support a wide range of SCM systems (like CVS and SVN). The usage in a WTP/Maven project has some peculiarities, which we will discuss below.</p> 
  <section> 
   <h4 id="Control_files">Control files</h4> 
   <p>Do not check in the Eclipse control files in your SCM, you can (and should) regenerate them every time you need them!</p> 
   <p>When using CVS, put these files in the .cvsignore file of every module. A basic version will look something like this:</p> 
   <div class="source"> 
    <pre>.classpath
.project
.settings
target</pre> 
   </div> 
   <p>For SVN, use the svn:ignore property in the root directory of each project.</p> 
  </section> 
  <section> 
   <h4 id="The_organization_project">The organization project</h4> 
   <p>One solution to sharing the exact Maven configuration between all developers, is to create a project containing the Maven binary release. This project can also be included in the SCM system, so that any updates (be it a new version or a configuration.change) are received by all developers.</p> 
  </section> 
 </section> 
 <section> 
  <h3 id="Multi_Project_Import.2FExport_Plugin">Multi Project Import/Export Plugin</h3> 
  <p>There is an Eclipe plugin available that can help a lot when using multi-module projects. This plugin can import several projects at once, and it can do so from both a deep and a flat structure.</p> 
  <p>The plugin is called "Multi Project Import/Export Plugin" and can be found <a class="externalLink" href="http://eclipse-tools.sourceforge.net/">here</a>. You can also reference the update site in eclipse, using the URL: <b>http://eclipse-tools.sourceforge.net/updates/</b></p> 
 </section> 
 <section> 
  <h3 id="Project_names">Project names</h3> 
  <p>The project names in Eclipse do not have to be the same as the name of the folder. Instead of forcing Maven to generate artifacts without version name (which is considered bad practice), the maven-eclipse-plugin can adapt the project names to include the version name! This way the artifact Eclipse generates, will have the same name as the artifact the Maven generates!</p> 
  <p>Many problems in the area of "the eclipse exported ear works, but the maven generated not" (or vice-versa) come from this different "final name" problem.</p> 
  <p>The best way to evade such problems is to use this setting for the maven-eclipse-plugin:</p> 
  <div class="source"> 
   <pre>&lt;projectNameTemplate&gt;[artifactId]-[version]&lt;/projectNameTemplate&gt;</pre> 
  </div> 
 </section> 
 <section> 
  <h3 id="The_pom_modules">The pom modules</h3> 
  <p>The root of the projects in Maven is always a POM-module. These projects can be imported into Eclipse as well, which then enables you to create and use <b>External Tool-launches</b> with workspace-locations. This makes the launches also exchangeable between developers and they can therefore also be stored in SCM.</p> 
  <section> 
   <h4 id="Duplicate_folders">Duplicate folders</h4> 
   <p>Some peculiarities you will have to remember when you checked out the root pom project in your workspace:</p> 
   <ul> 
    <li>first synchronize the modules</li> 
    <li>then <b>refresh</b> the pom project (this step is <b>very</b> important!)</li> 
    <li>then synchonize the root pom project <br>(only necessary when the root pom changed or you created a new module)</li> 
   </ul> 
   <p>Watch out that the files accessible in modules under the root pom project, are <b>physically</b> the same files as in the imported projects. Eclipse will show the any changes after the next refresh.</p> 
  </section> 
 </section> 
 <section> 
  <h3 id="Maven_builds_as_launches">Maven builds as launches</h3> 
  <p>As was said above, it is very useful to have your Maven builds inside Eclipse as a Launch-configuration. To create these, you should create a new External Tool and fill out the following values:</p> 
  <ul> 
   <li>Name: <p>The name for the launch -- this can be chosen freely.</p></li> 
   <li>Location: 
    <div class="source"> 
     <pre>  ${env_var:JAVA_HOME}/bin/java</pre> 
    </div> <p>If you're on Windows, you should add the '.exe' extension to the above command.</p> <p>Or, if you really want to make the builds interoperable, all developers should create a variable in their workspace called 'JAVA_EXECUTABLE', holding either the value 'java' (linux) or 'java.exe' (windows). The above command can then be changed into</p> 
    <div class="source"> 
     <pre>  ${env_var:JAVA_HOME}/bin/${JAVA_EXECUTABLE}</pre> 
    </div></li> 
   <li>Working Directory: <p>Select the root pom project here.</p> 
    <div class="source"> 
     <pre>  ${workspace_loc:/j2ee-simple}</pre> 
    </div></li> 
   <li>Arguments: <p>In the example below, we presume you have made the organization-project containing the Maven distribution. The project is called 'organization'.</p> 
    <div class="source"> 
     <pre>  -Dclassworlds.conf=${resource_loc:organization/maven-2.0/bin/m2.conf} 
  -Dmaven.home=${resource_loc:organization/maven-2.0}
  -classpath ${resource_loc:organization/maven-2.0/core/boot/classworlds-1.1.jar}
   org.codehaus.classworlds.Launcher

  -DdownloadSources=true
  -Dmaven.test.skip=${string_prompt:maven.test.skip:false}  
   clean eclipse:clean eclipse:eclipse install</pre> 
    </div> <p>The last three lines are configurations for plugins and the actual goals to run. These can be changed if necessary.</p> <p>The second to last line is used to have Eclipse prompt for running or skipping tests. Enter 'true' to skip the tests, anything else will run the tests.</p></li> 
   <li>Refresh / Refresh resources upon completion <p>Best to activate "The entire workspace" just to be sure all projects are aware of changes.</p></li> 
   <li>Common / Save as Shared file <p>Best to select the Root pom project location. The resulting launch file can be put under SCM control.</p></li> 
  </ul> 
 </section> 
 <section> 
  <h3 id="The_EAR_project">The EAR project</h3> 
  <p>WTP saves some extra information in the application.xml that would otherwise be generated by the maven-ear-plugin. We do not want to interfere with the maven-ear-plugin, so the maven-eclipse-plugin generates a special application.xml for WTP. This enables you to use the WTP deployer in the server view.</p> 
  <p>Important: this generated version of the application.xml will <b>NOT</b> be used in the maven build.</p> 
 </section> 
 <section> 
  <h3 id="The_EJB_project">The EJB project</h3> 
  <p>WTP automatically uses the ejbModule's source folder, but it is not mandatory. Use the Maven location instead: 'src/main/resources' for the ejb-jar.xml (etc) and 'src/main/java' for the JAVA-beans.</p> 
  <p>TIP: if WTP can not read your deployment descriptor, check if you included a 'display-name'-tag and specified the <i>xml encoding</i> in the xml file.</p> 
 </section> 
 <section> 
  <h3 id="The_WAR_project">The WAR project</h3> 
  <p>Early versions of WTP had some problems when no toplevel directory was used for the webcontent. As of v1.5 this problem is no longer there! This enables using the standard maven directory 'src/main/webapp' as the web-content folder. </p> 
  <p>The WEB-INF/classes directory can still trigger problems, therefore it is best <b>not</b> to include JAVA classes in a war module. Just put them in a separate JAVA (JAR) module and a lot of undetermined problems disappear. </p> 
  <p>WTP needs the context root in the war project, but in Maven it is defined in the ear project. As long as the ear project is available in the reactor (as part of the same multi module build) the eclipse plugin will take the context root from the ear project configuration. </p> 
 </section> 
 <section> 
  <h3 id="The_Eclipse_MANIFEST_files">The Eclipse MANIFEST files</h3> 
  <p>In Maven the manifest is generated by the maven-jar-plugin from the dependencies just before packaging, but WTP needs them to run. The maven-eclipse-plugin will generate a manifest that is available only to Eclipse (located at 'target/generated-resources/eclipse/META-INF/MANIFEST.MF'), meaning that it will be ignored in the normal maven build.</p> 
 </section> 
 <section> 
  <h3 id="Deploying_with_WTP">Deploying with WTP</h3> 
  <p>When you followed all directions described here, there should be no problem to deploy your EARs using the WTP tools for your application server. So there is no need to start a maven build after every change. </p> 
 </section> 
 <section> 
  <h3 id="Finally">Finally</h3> 
  <p>The configuration of the maven-eclipse-plugin used in this description is:</p> 
  <div class="source"> 
   <pre>  &lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-eclipse-plugin&lt;/artifactId&gt;
    &lt;version&gt;3.2.1-SNAPSHOT&lt;/version&gt;
    &lt;configuration&gt;
      &lt;projectNameTemplate&gt;[artifactId]-[version]&lt;/projectNameTemplate&gt;
      &lt;wtpmanifest&gt;true&lt;/wtpmanifest&gt;
      &lt;wtpapplicationxml&gt;true&lt;/wtpapplicationxml&gt;
      &lt;wtpversion&gt;2.0&lt;/wtpversion&gt;
      &lt;manifest&gt;${basedir}/src/main/resources/META-INF/MANIFEST.MF&lt;/manifest&gt;
    &lt;/configuration&gt;
  &lt;/plugin&gt;</pre> 
  </div> 
 </section> 
</section>
      </div>
    </div>
    <div class="span4">
      <div id="toc-sidebar">
        <div class="well">
          <ul class="nav nav-list">
            <li class="nav-header">Table of Contents</li>
    <li class="dropdown"><a href="#Using_maven-eclipse-plugin_in_multi-module_projects_with_WTP" title="Using maven-eclipse-plugin in multi-module projects with WTP">Using maven-eclipse-plugin in multi-module projects with WTP <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#The_flat_project_structure" title="The flat project structure">The flat project structure</a>
    <li class="dropdown"><a href="#The_Example_project" title="The Example project">The Example project <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Step_by_step" title="Step by step">Step by step</a>
        <li class="divider"></li>
      </ul>
    </li>
    <li class="dropdown"><a href="#Source_Control_Management" title="Source Control Management">Source Control Management <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Control_files" title="Control files">Control files</a>
    <li><a href="#The_organization_project" title="The organization project">The organization project</a>
        <li class="divider"></li>
      </ul>
    </li>
    <li><a href="#Multi_Project_Import.2FExport_Plugin" title="Multi Project Import/Export Plugin">Multi Project Import/Export Plugin</a>
    <li><a href="#Project_names" title="Project names">Project names</a>
    <li class="dropdown"><a href="#The_pom_modules" title="The pom modules">The pom modules <b class="caret"></b></a>
      <ul class="nav nav-list">
    <li><a href="#Duplicate_folders" title="Duplicate folders">Duplicate folders</a>
        <li class="divider"></li>
      </ul>
    </li>
    <li><a href="#Maven_builds_as_launches" title="Maven builds as launches">Maven builds as launches</a>
    <li><a href="#The_EAR_project" title="The EAR project">The EAR project</a>
    <li><a href="#The_EJB_project" title="The EJB project">The EJB project</a>
    <li><a href="#The_WAR_project" title="The WAR project">The WAR project</a>
    <li><a href="#The_Eclipse_MANIFEST_files" title="The Eclipse MANIFEST files">The Eclipse MANIFEST files</a>
    <li><a href="#Deploying_with_WTP" title="Deploying with WTP">Deploying with WTP</a>
    <li><a href="#Finally" title="Finally">Finally</a>
        <li class="divider"></li>
      </ul>
    </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  </div>

  </div>

  <!-- Footer
  ================================================== -->
  <footer class="well">
    <div class="container">
      <div class="row">
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Overview</li>
            <li >
              <a href="../index.html" title="Introduction">Introduction</a>
            </li>
            <li >
              <a href="../plugin-info.html" title="Goals">Goals</a>
            </li>
            <li >
              <a href="../usage.html" title="Usage">Usage</a>
            </li>
            <li >
              <a href="../faq.html" title="FAQ">FAQ</a>
            </li>
            <li >
              <a href="../trouble-shooting/index.html" title="Trouble Shooting">Trouble Shooting</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Configuration</li>
            <li >
              <a href="../reactor.html" title="Multiple Module Projects">Multiple Module Projects</a>
            </li>
            <li >
              <a href="../pde.html" title="Eclipse PDE Projects">Eclipse PDE Projects</a>
            </li>
            <li >
              <a href="../wtp.html" title="WTP Support">WTP Support</a>
            </li>
          </ul>
        </div>
        <div class="span2 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Examples</li>
            <li >
              <a href="additional-facets.html" title="Adding additional facets">Adding additional facets</a>
            </li>
            <li >
              <a href="ajdt-projects.html" title="AJDT Projects">AJDT Projects</a>
            </li>
            <li >
              <a href="attach-library-sources.html" title="Attach Library Sources">Attach Library Sources</a>
            </li>
            <li >
              <a href="configure-checkstyle.html" title="Configure Checkstyle">Configure Checkstyle</a>
            </li>
            <li >
              <a href="load-code-styles.html" title="Load Code Style file">Load Code Style file</a>
            </li>
            <li class="active">
              <a href="#" title="Multi-module projects with WTP">Multi-module projects with WTP</a>
            </li>
            <li >
              <a href="prevent-module-references.html" title="Prevent Module References">Prevent Module References</a>
            </li>
            <li >
              <a href="provide-project-natures-and-build-commands.html" title="Provide Project Natures And Build Commands">Provide Project Natures And Build Commands</a>
            </li>
            <li >
              <a href="specifying-source-path-inclusions-and-exclusions.html" title="Specifying source path inclusions and exclusions">Specifying source path inclusions and exclusions</a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-nav">
          <ul class="nav nav-list">
            <li class="nav-header">Maven documentation</li>
            <li >
              <a href="../project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
            </li>
            <li >
              <a href="../project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
            </li>
          </ul>
        </div>
        <div class="span3 bottom-description">
          <blockquote>wcm.io DevOps is an Open Source project which provides tools for configuration management and deployment.</blockquote>
        </div>
      </div>
    </div>
  </footer>

  <div class="container subfooter">
    <div class="row">
      <div class="span12">
        <p class="pull-right"><a href="#">Back to top</a></p>
        <p class="copyright">Copyright &copy;2015-2024 <a href="https://devops.wcm.io">wcm.io DevOps</a>. All Rights Reserved.</p>
        <p class="version-date"><span class="projectVersion">Version: 3.2.1-SNAPSHOT. </span><span class="publishDate">Last Published: 2024-12-09. </span></p>
      </div>
    </div>
  </div>

  <!-- JavaScript
  ================================================== -->
  <script src="https://devops.wcm.io/js/jquery.min.js"></script>
  <script src="https://devops.wcm.io/js/bootstrap.min.js"></script>
  <script src="https://devops.wcm.io/js/lightbox.min.js"></script>
  <script src="https://devops.wcm.io/js/reflow-scroll.js"></script>
  <script src="https://devops.wcm.io/js/json5.min.js"></script>
  <script src="https://devops.wcm.io/js/reflow-json-jcr-convert.js"></script>
  <script src="https://devops.wcm.io/js/highlight.min.js"></script>


  <script src="https://devops.wcm.io/js/reflow-skin.js"></script>

  </body>
</html>