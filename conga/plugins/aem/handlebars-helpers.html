<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/handlebars-helpers.md at 2022-05-09

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>CONGA AEM Plugin &#x2013; CONGA - Custom Handlebars expressions for AEM</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">CONGA AEM Plugin
</div>
<div id="bannerRight"><img src="https://devops.wcm.io/conga/images/conga.png" style="height:120px"/>
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2022-05-09</span>
           | <span id="projectVersion">Version: 2.16.3-SNAPSHOT</span>
      </div>
      <div class="xright">      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="CONGA_-_Custom_Handlebars_expressions_for_AEM"></a>CONGA - Custom Handlebars expressions for AEM</h2>
<p>By using CONGA handlebars helper plugins it is possible to extend handlebars by registering custom expressions. Out of the box CONGA AEM plugin ships with a set of built-in custom expressions documented in this chapter.</p>
<p>The basic handlebars expressions are documented in the <a href="../../handlebars-quickstart.html">Handlebars quickstart</a>. CONGA itself also ships with a set of <a href="../../handlebars-helpers.html">Custom Handlebars expressions</a>.</p><section>
<h3><a name="aemCryptoEncrypt"></a>aemCryptoEncrypt</h3>
<p><i>This works only with (unobfuscated) crypto keys for AEM 6.3 an up.</i></p>
<p>Encrypts a password or other secret with the AEM crypto AES key.</p>

<div class="source">
<pre><code>{{aemCryptoEncrypt passwordVariable}}
</code></pre></div>
<p>This requires a plugin configuration that defines the path to the AEM crypto key to use (which has to be deployed to the target instances as well):</p>

<div class="source">
<pre><code class="language-xml">&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.devops.conga&lt;/groupId&gt;
  &lt;artifactId&gt;conga-maven-plugin&lt;/artifactId&gt;
  &lt;extensions&gt;true&lt;/extensions&gt;
  &lt;configuration&gt;
    &lt;pluginConfig&gt;
      aem-plugin;cryptoAesKeyUrl=classpath:/crypto/master
    &lt;/pluginConfig&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre></div>
<p>It is recommended to encrypt the key in your SCM using Ansible Vault and reference it like this: <code>aem-plugin;cryptoAesKeyUrl=ansible-vault:classpath:/crypto/master</code>. You can store it on other locations as well (filesystem, Maven, HTTP etc.).</p>
<p>If you want to write a generic template that runs with and without having a crypto key available you can add a <code>ignoreMissingKey</code> parameter - but in this case the password or secret is inserted unencrypted if the key is missing!</p>

<div class="source">
<pre><code>{{aemCryptoEncrypt passwordVariable ignoreMissingKey=true}}
</code></pre></div>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th>Plugin configuration parameter</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>cryptoAesKeyUrl</code></td>
<td>Path to the AEM crypto key to use</td></tr>
<tr class="a">
<td align="left"><code>cryptoSkip</code></td>
<td>If set to <code>true</code> encryption is skipped and the value ins inserted unencrypted.</td></tr>
</tbody>
</table></section><section>
<h3><a name="httpHost"></a>httpHost</h3>
<p>Renders the HTTP host with port, when the port is not the default one (80).</p>
<p><b>Example 1 (default port):</b></p>

<div class="source">
<pre><code>{{httpHost &quot;localhost&quot; port=80 }}
</code></pre></div>
<p>Result: <code>localhost</code></p>
<p><b>Example 2 (custom port):</b></p>

<div class="source">
<pre><code>{{httpHost &quot;localhost&quot; port=8080 }}
</code></pre></div>
<p>Result: <code>localhost:8080</code></p></section><section>
<h3><a name="httpHostSsl"></a>httpHostSsl</h3>
<p>Renders the SSL HTTP host with port, when the port is not the default one (443).</p>
<p><b>Example 1 (default port):</b></p>

<div class="source">
<pre><code>{{httpHost &quot;localhost&quot; port=443 }}
</code></pre></div>
<p>Result: <code>localhost</code></p>
<p><b>Example 2 (custom port):</b></p>

<div class="source">
<pre><code>{{httpHost &quot;localhost&quot; port=8443 }}
</code></pre></div>
<p>Result: <code>localhost:8443</code></p></section><section>
<h3><a name="oakPasswordHash"></a>oakPasswordHash</h3>
<p>Generates a password hash for an Oak JCR user from a plain text password.</p>

<div class="source">
<pre><code>{{oakPasswordHash passwordVariable}}
</code></pre></div></section><section>
<h3><a name="oakAuthorizableUuid"></a>oakAuthorizableUuid</h3>
<p>Generates a UUID for an authorizable node by deriving it from the authorizable Id.</p>

<div class="source">
<pre><code>{{oakAuthorizableUuid authorizableId}}
</code></pre></div></section><section>
<h3><a name="webconsolePasswordHash"></a>webconsolePasswordHash</h3>
<p>Generates a password hash for the  Apache Felix Webconsole (felix.webconsole.password).</p>

<div class="source">
<pre><code>{{webconsolePasswordHash passwordVariable}}
</code></pre></div></section><section>
<h3><a name="aemHttpdFilter"></a>aemHttpdFilter</h3>
<p>Generates HTTPd allow from/required rules for a filter expression. Supports both Apache 2.2 and 2.4. See <a href="../../definitions/aem/">CONGA AEM Definitions</a> for an usage example.</p>

<div class="source">
<pre><code># Location filter
{{#each httpd.accessRestriction.locationFilter~}}
{{aemHttpdFilter this allowFromKey=&quot;httpd.accessRestriction.adminAccessFromIp&quot; allowFromHostKey=&quot;httpd.accessRestriction.adminAccessFromHost&quot;}}
{{/each~}}
</code></pre></div></section><section>
<h3><a name="aemDispatcherFilter"></a>aemDispatcherFilter</h3>
<p>Generates AEM dispatcher filter rules for a filter expression. See <a href="../../definitions/aem/">CONGA AEM Definitions</a> for an usage example.</p>

<div class="source">
<pre><code>  /filter
    {
{{~#each dispatcher.filter}}
      /{{@index}}
        {{{aemDispatcherFilter this}}}
{{~/each}}
    }
</code></pre></div></section><section>
<h3><a name="httpdCloudManagerConditional.2C_withAllCloudManagerConditional"></a>httpdCloudManagerConditional, withAllCloudManagerConditional</h3>
<p>Used to build envrionment-conditional  configuration sections for AEM cloud service.</p></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2015&#x2013;2022<a href="https://devops.wcm.io">wcm.io DevOps</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>