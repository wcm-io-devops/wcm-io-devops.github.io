<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/markdown/extensions.md at 2021-09-09

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>CONGA AEM Plugin &#x2013; CONGA - Extensions</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">CONGA AEM Plugin
</div>
<div id="bannerRight"><img src="https://devops.wcm.io/conga/images/conga.png" style="height:120px"/>
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2021-09-09</span>
          &#xA0;| <span id="projectVersion">Version: 1.14.7-SNAPSHOT</span>
      </div>
      <div class="xright">      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="CONGA_-_Extensions"></a>CONGA - Extensions</h2>
<p>The CONGA AEM Plugin extends CONGA using its <a class="externalLink" href="https://devops.wcm.io/conga/extensibility.html">extensibility model</a>.</p><section>
<h3><a name="Provided_Plugins"></a>Provided Plugins</h3>
<p>File plugins:</p>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th> Plugin name                     </th>
<th> File name(s)        </th>
<th align="center"> File Header </th>
<th align="center"> Validator </th>
<th align="center"> Escaping </th>
<th align="center"> Post Processor </th></tr>
</thead><tbody>

<tr class="b">
<td> <code>any</code>                           </td>
<td> .any                </td>
<td align="center"> X           </td>
<td align="center"> X         </td>
<td align="center"> X        </td>
<td align="center">                </td></tr>
<tr class="a">
<td> <code>aem-contentpackage</code>            </td>
<td> .json               </td>
<td align="center">             </td>
<td align="center"> X         </td>
<td align="center">          </td>
<td align="center"> X              </td></tr>
<tr class="b">
<td> <code>aem-contentpackage-osgiconfig</code> </td>
<td> .provisioning, .txt </td>
<td align="center">             </td>
<td align="center"> X         </td>
<td align="center">          </td>
<td align="center"> X              </td></tr>
<tr class="a">
<td> <code>aem-contentpackage-properties</code> </td>
<td> .zip                </td>
<td align="center">             </td>
<td align="center">           </td>
<td align="center">          </td>
<td align="center"> X              </td></tr>
</tbody>
</table>
<p>Please note: Files with the extension <code>txt</code> are only managed as provisioning files if the contain the string &quot;[feature &quot; (heuristic).</p></section><section>
<h3><a name="Generating_AEM_Content_Packages"></a>Generating AEM Content Packages</h3>
<p>The CONGA AEM Plugin provides two post processor plugins that generate AEM Content Packages (ZIP files with JCR XML files describing a JCR content structure). These content packages can be imported into a AEM instance using the CRX Package Manager.</p>
<p>The plugin <code>aem-contentpackage</code> generates a content package out of a JSON file. This JSON files contains JCR content as produced by the Sling GET Servlet.</p>
<p>The plugin <code>aem-contentpackage-osgiconfig</code> generates a content package containing OSGI configurations out of a Sling Provisioning file.</p>
<p>The Sling Provisioning Model file format is described on the <a class="externalLink" href="https://sling.apache.org/documentation/development/slingstart.html">Sling Website</a>. It is a compact format that allows to define features with bundles and configurations for a Sling-based distribution. The CONGA AEM Plugin uses only the configurations and ignores all other parts of the file.</p>
<p>Both post processor plugins support a set of options that allow further configuration of the generated content package:</p>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th> Property                        </th>
<th> Description</th></tr>
</thead><tbody>

<tr class="b">
<td> <code>contentPackage.group</code>          </td>
<td> Group name for content package</td></tr>
<tr class="a">
<td> <code>contentPackage.name</code>           </td>
<td> Package name for content package</td></tr>
<tr class="b">
<td> <code>contentPackage.description</code>    </td>
<td> Description for content package</td></tr>
<tr class="a">
<td> <code>contentPackage.version</code>        </td>
<td> Version for content package</td></tr>
<tr class="b">
<td> <code>contentPackage.rootPath</code>       </td>
<td> Root path for the content package</td></tr>
<tr class="a">
<td> <code>contentPackage.filters</code>        </td>
<td> Contains list with filter definitions, optionally with include/exclude rules. If not defined a simple filter rule is derived from the <code>contentPackage.rootPath</code> property.</td></tr>
<tr class="b">
<td> <code>contentPackage.acHandling</code>     </td>
<td> How to apply ACLs that are contained in the content package. Possible values: <code>ignore</code> (default), <code>overwrite</code>, <code>merge</code>, <code>merge_preserve</code>, <code>clear</code>.</td></tr>
<tr class="a">
<td> <code>contentPackage.thumbnailImage</code> </td>
<td> URL to thumbnail PNG image to be used for the content package. URL file plugin prefixes can be used (e.g. <code>classpath:</code>).</td></tr>
<tr class="b">
<td> <code>contentPackage.files</code>          </td>
<td> List of additional binary files to be included in content package. For each file you have to specify a <code>path</code> property (target path), and for the source an <code>url</code> property for an external file, or a <code>file</code> and <code>dir</code> property for a file that was generated by CONGA. Instead of <code>file</code> your can also use <code>fileMath</code> to include multiple files matching this pattern. If the file should be deleted after the inclusion you can additionally specify <code>delete: true</code>.</td></tr>
<tr class="a">
<td> <code>contentPackage.properties</code>     </td>
<td> Defines map with additional custom properties for package metadata.</td></tr>
<tr class="b">
<td> <code>contentPackage.packageType</code>    </td>
<td> Defines the <a class="externalLink" href="http://jackrabbit.apache.org/filevault-package-maven-plugin/generate-metadata-mojo.html#packageType">packageType</a> for the content package. Uses for <a class="externalLink" href="https://jackrabbit.apache.org/filevault/validation.html">FileVault validation</a> of the package.</td></tr>
<tr class="a">
<td> <code>contentPackage.requiresRoot</code>   </td>
<td> Package requires root.</td></tr>
<tr class="b">
<td> <code>contentPackage.requiresRestart</code></td>
<td> Package requires restart.</td></tr>
<tr class="a">
<td> <code>contentPackage.allowIndexDefinitions</code> </td>
<td> Package allows index definitions.</td></tr>
</tbody>
</table>
<p>Example for defining package properties with a set of filters:</p>

<div class="source">
<div class="source">
<pre># Define a AEM content package with some JCR content (Sling Mapping Example)
- file: sling-mapping.json
  dir: packages
  template: sling-mapping.json.hbs
  # Post-processors apply further actions after generation the file
  postProcessors:
  - aem-contentpackage
  postProcessorOptions:
    contentPackage:
      name: mapping-sample
      rootPath: /etc/map/http
      filters:
      - filter: /etc/map/http
        rules:
        - rule: exclude
          pattern: /etc/map/http
        - rule: include
          pattern: /etc/map/http/.*
        - rule: exclude
          pattern: /etc/map/http/AppMeasurementBridge
</pre></div></div>

<p>Example for additionally adding binary files to the content package:</p>

<div class="source">
<div class="source">
<pre># Define a AEM content package with some JCR content
- file: my-package.json
  dir: packages
  template: my-package.json.hbs
  # Post-processors apply further actions after generation the file
  postProcessors:
  - aem-contentpackage
  postProcessorOptions:
    contentPackage:
      name: my-package
      rootPath: /content/files
      files:
      # Add a static file from the class paths (or other URLs)
      - url: classpath:/my-resources/file1.txt
        path: /content/files/file1.txt
      # Add a file that was generated by CONGA (delete after inclusion in package)
      - file: generated-file.txt
        dir: generated-files
        path: /content/files/generated-file.txt
        delete: true
      # Add a set file that were generated by CONGA (delete after inclusion in package)
      - fileMatch: file_(.*)\.txt
        dir: generated-files
        path: /content/files/$1.txt
        delete: true
</pre></div></div>
</section><section>
<h3><a name="Validating_AEM_Content_Packages"></a>Validating AEM Content Packages</h3>
<p>AEM content packages generated by <code>aem-contentpackage</code> or <code>aem-contentpackage-osgiconfig</code> are validated automatically using the <a class="externalLink" href="https://jackrabbit.apache.org/filevault/validation.html">FileVault validation</a>. The type of validation relies on the <a class="externalLink" href="http://jackrabbit.apache.org/filevault-package-maven-plugin/generate-metadata-mojo.html#packageType">packageType</a> that is set for this package (and is disabled if no package type is set). The validation and configuration is similar to that of the <a class="externalLink" href="http://jackrabbit.apache.org/filevault-package-maven-plugin/">Jackrabbit FileVault Package Maven Plugin</a>.</p>
<p>Example for reconfiguring a FileVault filter:</p>

<div class="source">
<div class="source">
<pre>  validatorOptions:
    contentPackage.validatorsSettings:
      jackrabbit-filter:
        options:
          validRoots: /etc/replication
</pre></div></div>

<p>Example for disabling a FileVault filter:</p>

<div class="source">
<div class="source">
<pre>  validatorOptions:
    contentPackage.validatorsSettings:
      jackrabbit-filter:
        isDisabled: true
</pre></div></div>

<p>See <a class="externalLink" href="https://jackrabbit.apache.org/filevault/validation.html">FileVault validation</a> for all available filters and options.</p></section><section>
<h3><a name="Post-processing_AEM_Content_Packages"></a>Post-processing AEM Content Packages</h3>
<p>With the post-processor plugin <code>aem-contentpackage-properties</code> is applied automatically to all ZIP files manged by CONGA. The properties contained in the AEM package are extracted and included per file in a property <code>aemContentPackageProperties</code> in the model YAML.</p>
<p>The model YAML file can be exported during CONGA generation and provides the necessary runtime information for deployment tools like Ansible.</p></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2015&#x2013;2021<a href="https://devops.wcm.io">wcm.io DevOps</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>