<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.11.1 from src/site/markdown/extensions.md at 2022-04-27

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.11.1" />
    <title>CONGA Ansible Plugin &#x2013; CONGA - Extensions</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">CONGA Ansible Plugin
</div>
<div id="bannerRight"><img src="https://devops.wcm.io/conga/images/conga.png" style="height:120px"/>
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2022-04-27</span>
           | <span id="projectVersion">Version: 1.3.3-SNAPSHOT</span>
      </div>
      <div class="xright">      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<section>
<h2><a name="CONGA_-_Extensions"></a>CONGA - Extensions</h2>
<p>The CONGA Ansible Plugin extends CONGA using its <a class="externalLink" href="https://devops.wcm.io/conga/extensibility.html">extensibility model</a>.</p>
<p>Ansible supports reading dynamic files (executable scripts) for inventories, password files etc. - the CONGA Ansible plugin supports the following files/scripts:</p>
<ul>

<li>Static files</li>
<li>Python scripts (<code>.py</code> extension)</li>
</ul><section>
<h3><a name="Provided_Plugins"></a>Provided Plugins</h3><section>
<h4><a name="Value_Provider_Plugins"></a>Value Provider Plugins</h4>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th>Plugin name</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>ansible-vault</code></td>
<td>Allows to variables from encrypted <a class="externalLink" href="https://docs.ansible.com/ansible/latest/vault.html">Ansible Vault</a> files.</td></tr>
<tr class="a">
<td align="left"><code>ansible-inventory</code></td>
<td>Allows to read <a class="externalLink" href="http://docs.ansible.com/ansible/latest/intro_inventory.html">Ansible Inventory</a> files.</td></tr>
</tbody>
</table>
<p>You can also define multiple value providers of the same plugin type. See <a class="externalLink" href="https://devops.wcm.io/conga/tooling/conga-maven-plugin/generate-mojo.html#valueProvider">value provider configuration</a> for details.</p></section><section>
<h4><a name="URL_File_plugins"></a>URL File plugins</h4>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th>Plugin name</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>ansible-vault</code></td>
<td>Decrypts a file encrypted with [Ansible Vault][ansible-vault. Can be combined with other URL file plugins.</td></tr>
</tbody>
</table></section><section>
<h4><a name="Value_Encryption_plugins"></a>Value Encryption plugins</h4>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th>Plugin name</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>ansible-vault</code></td>
<td>Encrypts a single configuration parameter value with Ansible vault, to be stored as !vault tagged encrypted value in YAML file.</td></tr>
</tbody>
</table></section><section>
<h4><a name="YAML_Represent_plugins"></a>YAML Represent plugins</h4>
<table border="0" class="bodyTable">
<thead>

<tr class="a">
<th>Plugin name</th>
<th>Description</th></tr>
</thead><tbody>

<tr class="b">
<td align="left"><code>ansible-vault</code></td>
<td>Registers a custom represent implementations that controls the rendering of !vault tagged encrypted values in the node model export YAML file.</td></tr>
</tbody>
</table></section></section><section>
<h3><a name="Ansible_Vault"></a>Ansible Vault</h3>
<p><i><b>Please note:</b> You need to install the <a class="externalLink" href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html">Java Cryptography Extension (JCE) Unlimited Strength policy files</a> from Oracle, because Ansible uses 256 bit keys to handle encryption and decryption of the vault files. If you are using Java 8u162 or higher they are already active by default.</i></p>
<p>Ansible Vault files are files encrypted with <a class="externalLink" href="https://docs.ansible.com/ansible/latest/vault.html">Ansible Vault</a>. Ansible Vault requires a vault password to be set in the environment to decrypt the files. You can set the vault password by either:</p>
<ul>

<li>Setting the password via the system property:<br />
<code>-Dansible.vault.password=mypassword</code></li>
<li>Setting the password via the system property pointing to a password file:<br />
<code>-Dansible.vault.password.file=/path/to/password-file</code></li>
<li>Setting the system environment variable <code>ANSIBLE_VAULT_PASSWORD</code>.</li>
<li>Setting the system environment variable <code>ANSIBLE_VAULT_PASSWORD_FILE</code> pointing to the vault password file. This variable is used by Ansible itself as well.</li>
</ul><section>
<h4><a name="Reading_variables_from_Ansible_Vault_files"></a>Reading variables from Ansible Vault files</h4>
<p>If you have an Ansible Vault-encrypted file containing password or other parameters in YAML format, you can use the Ansible Vault value provider plugin to read them in CONGA.</p>
<p>Example YAML file <i>before encryption</i>:</p>

<div class="source">
<pre><code class="language-yaml">pwd1: abc
</code></pre></div>
<p>Using the value provider plugin for Ansible Vault you can the variables defined in the encrypted file.</p>
<p>Example:</p>
<ul>

<li><code>${ansible-vault::pwd1}</code> = abc</li>
</ul>
<p>Via configuration you need to tell the <a class="externalLink" href="https://devops.wcm.io/conga/tooling/conga-maven-plugin/plugin-info.html">CONGA Maven Plugin</a> (via the pom.xml or via system property) where to look up the file containing the encrypted variables, and the password to decrypt the data.</p>
<p>Example:</p>

<div class="source">
<pre><code class="language-xml">&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.devops.conga&lt;/groupId&gt;
  &lt;artifactId&gt;conga-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;valueProvider&gt;
      ansible-vault;file=${project.basedir}/vault/myvars
    &lt;/valueProvider&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre></div></section><section>
<h4><a name="Reading_and_decrypting_Ansible_Vault-encrypted_files"></a>Reading and decrypting Ansible Vault-encrypted files</h4>
<p>The URL File plugin for Ansible Vault allows to access (and decrypt) Ansible Vault-encrpyted files anywhere in CONGA where a URL path to a file can be given - e.g. in file definitions for roles. This can be combined with other URL file plugins, e.g. getting an encrypted file from classpath, HTTP URL or other sources and then decrypting it.</p>
<p>Example:</p>

<div class="source">
<pre><code class="language-yaml"># Copy file from classpath and decrypt it
- file: mysample.txt
  url: ansible-vault:classpath:/sample.txt
</code></pre></div></section></section><section>
<h3><a name="Ansible_Inventory"></a>Ansible Inventory</h3><section>
<h4><a name="Reading_Ansible_Inventory_files"></a>Reading Ansible Inventory files</h4>
<p>Ansible Inventory files are expected in a special format as used by the Ansible roles for AEM deployment with CONGA.</p>
<p>Example inventory:</p>

<div class="source">
<pre><code>[aem-author]
host-01

[aem-publish]
host-02
host-03
</code></pre></div>
<p>Using the value provider plugin for Ansible Inventory you can reference the list of host names for each group.</p>
<p>Example:</p>
<ul>

<li><code>${ansible-inventory::aem-author}</code> = host-01</li>
<li><code>${ansible-inventory::aem-publish}</code> = host-02,host-03</li>
</ul>
<p>Via configuration you need to tell the <a class="externalLink" href="https://devops.wcm.io/conga/tooling/conga-maven-plugin/plugin-info.html">CONGA Maven Plugin</a> (via the pom.xml or via system environment property) where to look up the Ansible Inventory file.</p>
<p>Example:</p>

<div class="source">
<pre><code class="language-xml">&lt;plugin&gt;
  &lt;groupId&gt;io.wcm.devops.conga&lt;/groupId&gt;
  &lt;artifactId&gt;conga-maven-plugin&lt;/artifactId&gt;
  &lt;configuration&gt;
    &lt;valueProvider&gt;
      ansible-inventory;file=${project.basedir}/inventory/inventory-example
    &lt;/valueProvider&gt;
  &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre></div>
<p>The implementation supports both the &#x201c;INI-style&#x201d; inventory format as shown above, as well as JSON-style inventories as <a class="externalLink" href="http://docs.ansible.com/ansible/latest/dev_guide/developing_inventory.html">documented here</a>.</p>
<p>If JSON-style inventories are used it's also possible to use a <a class="externalLink" href="https://github.com/json-path/JsonPath">JsonPath</a> expression for fetching data from the inventory. This example returns an array of matching values in the JSON data:</p>

<div class="source">
<pre><code>${ansible-inventory::$._meta.hostvars..[?(@.ec2_tag_Name == 'tag2')].ec2_private_ip_address}
</code></pre></div></section></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2015&#x2013;2022<a href="https://devops.wcm.io">wcm.io DevOps</a>.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>